<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>3D Model Viewer</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background: #5c5555;
        font-family: Geneva, sans-serif;
        color: rgba(0, 0, 0, 0.7);
      }
      #viewer {
        width: 100vw; 
        height: 100vh; 
        background: #9b9494;
        position: relative;
      }
      .controls {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
        z-index: 10;
      }
      .controls button {
        margin: 5px 0;
        width: 100px;
        padding: 5px;
        font-size: 14px;
      }
      #fps {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(255, 255, 255, 0.8);
        padding: 5px;
        border-radius: 5px;
        z-index: 10;
        font-size: 14px;
      }
      #loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        font-size: 16px;
        z-index: 20;
      }
    </style>
    <script src="./dist/js-3d-model-viewer.js"></script>
  </head>

  <body>
    <div id="viewer"></div>
    <div id="fps">FPS: --</div>
    <div id="loading">Loading: 0%</div>
    <div class="controls">
      <button id="top-view">Top</button>
      <button id="bottom-view">Bottom</button>
      <button id="back-view">Back</button>
      <button id="home-view">Home</button>
      <button id="zoom-in">Zoom In</button>
      <button id="zoom-out">Zoom Out</button>
      <button id="rotate-left">Rotate Left</button>
      <button id="rotate-right">Rotate Right</button>
    </div>

    <script>
      // Initialize the 3D model viewer
      var modelPlayer = this.Js3dModelViewer;
      var viewerElement = document.getElementById('viewer');
      var fpsElement = document.getElementById('fps');
      var loadingElement = document.getElementById('loading');

      var scene = modelPlayer.prepareScene(viewerElement, {
        grid: true, 
        background: '#D3D3D3', 
        showRuler: true 
      });

      // Load 3D model with progress updates
      modelPlayer.loadObject(
        scene,
        './assets/sample_02.obj',
        './assets/sample_02.mtl',
        {
          onProgress: function (progress) {
            const percentage = Math.floor(progress * 100);
            loadingElement.innerText = `Loading: ${percentage}%`;
          },
          onComplete: function () {
            loadingElement.style.display = 'none';
            console.log("Model loaded successfully");
          },
        }
      );

      // FPS Meter
      function updateFPS() {
        const fps = modelPlayer.getFPS();
        fpsElement.innerText = `FPS: ${fps}`;
        requestAnimationFrame(updateFPS);
      }
      updateFPS();

      // View Controls
      document.getElementById('top-view').addEventListener('click', function () {
        modelPlayer.setCameraPosition(scene, { x: 0, y: 50, z: 0 });
      });
      document.getElementById('bottom-view').addEventListener('click', function () {
        modelPlayer.setCameraPosition(scene, { x: 0, y: -50, z: 0 });
      });
      document.getElementById('back-view').addEventListener('click', function () {
        modelPlayer.setCameraPosition(scene, { x: -50, y: 0, z: 0 });
      });
      document.getElementById('home-view').addEventListener('click', function () {
        modelPlayer.resetCamera(scene);
      });

      // Zoom and Rotate Controls
      document.getElementById('zoom-in').addEventListener('click', function () {
        modelPlayer.zoom(scene, 1.1); 
      });
      document.getElementById('zoom-out').addEventListener('click', function () {
        modelPlayer.zoom(scene, 0.9); 
      });
      document.getElementById('rotate-left').addEventListener('click', function () {
        modelPlayer.rotate(scene, { y: -10 });
      });
      document.getElementById('rotate-right').addEventListener('click', function () {
        modelPlayer.rotate(scene, { y: 10 });
      });

      // Ensure full-screen mode is always enabled
      modelPlayer.goFullScreen(viewerElement);
    </script>
  </body>
</html>
