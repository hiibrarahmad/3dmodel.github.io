<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Interactive 3D Model Viewer</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background: #5c5555; /* Background color */
        font-family: Geneva, sans-serif;
        color: rgba(0, 0, 0, 0.7);
        overflow: hidden;
      }
      #viewer {
        width: 100vw;
        height: 100vh;
        background: #9b9494; /* Viewer background */
        position: relative;
      }
      #loading-bar {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        display: none;
        z-index: 20;
      }
      #loading-bar span {
        display: block;
        font-size: 1.2em;
        margin-bottom: 10px;
      }
      #loading-progress {
        width: 200px;
        height: 20px;
        background: #ddd;
        border-radius: 10px;
        overflow: hidden;
      }
      #loading-progress div {
        height: 100%;
        background: #3CB371;
        width: 0;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r138/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r138/examples/js/controls/OrbitControls.js"></script>
  </head>

  <body>
    <div id="viewer"></div>
    <div id="loading-bar">
      <span>Loading...</span>
      <div id="loading-progress">
        <div></div>
      </div>
    </div>

    <script>
      const viewerElement = document.getElementById('viewer');
      const loadingBar = document.getElementById('loading-bar');
      const loadingProgress = document.querySelector('#loading-progress div');

      // Scene, Camera, Renderer
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      viewerElement.appendChild(renderer.domElement);

      // Lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);
      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
      directionalLight.position.set(10, 10, 10).normalize();
      scene.add(directionalLight);

      // Orbit Controls
      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.1;
      controls.zoomSpeed = 0.5;

      // Camera Position
      camera.position.set(0, 5, 10);
      controls.update();

      // Loading Manager
      const manager = new THREE.LoadingManager();
      manager.onStart = function () {
        loadingBar.style.display = 'block';
      };
      manager.onProgress = function (url, loaded, total) {
        const progress = Math.floor((loaded / total) * 100);
        loadingProgress.style.width = `${progress}%`;
      };
      manager.onLoad = function () {
        loadingBar.style.display = 'none';
      };

      // Load 3D Model
      const loader = new THREE.ObjectLoader(manager);
      loader.load(
        './assets/sample_02.json', // Replace with actual file path
        (object) => {
          scene.add(object);
        },
        undefined,
        (error) => {
          console.error('An error occurred while loading the model', error);
        }
      );

      // Animate the scene
      function animate() {
        controls.update();
        renderer.render(scene, camera);
        requestAnimationFrame(animate);
      }
      animate();

      // Handle window resize
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  </body>
</html>
